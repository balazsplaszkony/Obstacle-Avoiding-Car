/*
 * PID.h
 *
 *  Created on: 2023. m√°rc. 27.
 *      Author: plasz
 */

#ifndef PID_H_
#define PID_H_
#include <stdbool.h>
#include <math.h>
#include <stdint.h>


/* Allowable PWM duty cycle is between 40% and 80%
 * For higher resolution it's scaled up to between 400 and 800
*/
#define MAX_PID_OUTPUT 400
#define MIN_PID_OUTPUT 800

extern volatile bool pid_updated;
typedef struct {
    float Kp;
    float Ki;
    float Kd;
    uint8_t setpoint;
    float integral;
    float last_error;
    float output;
    float min_output;
    float max_output;
} PidController;

extern PidController pid_right;
extern PidController pid_left;

bool isPIDUpdated();
void PIDContollerUpdate(PidController* pid, uint8_t measurement);
void PIDInit();
int RoundPIDOutput(float output);

#endif /* PID_H_ */
